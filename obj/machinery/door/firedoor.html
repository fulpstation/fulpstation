<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../../../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;obj&#x2F;machinery&#x2F;door&#x2F;firedoor - &#x2F;tg&#x2F; Station 13</title>
</head>
<body>
<header>
    <a href="index.html">&#x2F;tg&#x2F; Station 13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="obj/machinery/door/firedoor.html#var">Var Details</a> - <a href="obj/machinery/door/firedoor.html#proc">Proc Details</a></header>
<main>
<h1>firedoor <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/door.html">door</a>/<a href="obj/machinery/door/firedoor.html">firedoor</a></aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L6">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 6"/></a></h1>

<table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/active">active</a></th><td>Is this firelock active/closed?</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/affecting_areas">affecting_areas</a></th><td>List of areas we handle. See CalculateAffectingAreas()</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/alarm_type">alarm_type</a></th><td>Type of alarm we're under. See code/defines/firealarm.dm for the list. This var being null means there is no alarm.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/assemblytype">assemblytype</a></th><td>The type of door frame to drop during deconstruction</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/being_held_open">being_held_open</a></th><td>Tracks if the firelock is being held open by a crowbar. If so, we don't close until they walk away</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/ignore_alarms">ignore_alarms</a></th><td>Should the firelock ignore atmosphere when choosing to stay open/closed?</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/is_playing_alarm">is_playing_alarm</a></th><td>Keeps track of if we're playing the alarm sound loop (as only one firelock per group should be). Used during power changes.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/issue_turfs">issue_turfs</a></th><td>List of problem turfs with bad temperature</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/light_xoffset">light_xoffset</a></th><td>X offset for the overlay lights, so that they line up with the thin border firelocks</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/light_yoffset">light_yoffset</a></th><td>Y offset for the overlay lights, so that they line up with the thin border firelocks</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/luminosity">luminosity</a></th><td>Trick to get the glowing overlay visible from a distance</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/merger_id">merger_id</a></th><td>The merger_id and merger_typecache variables are used to make rows of firelocks activate at the same time.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/my_area">my_area</a></th><td>For the few times we affect only the area we're actually in. Set during Init. If we get moved, we don't update, but this is consistant with fire alarms and also kinda funny so call it intentional.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/soundloop">soundloop</a></th><td>looping sound datum for our fire alarm siren.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#var/warn_lights">warn_lights</a></th><td>Overlay object for the warning lights. This and some plane settings allows the lights to glow in the dark.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/CalculateAffectingAreas">CalculateAffectingAreas</a></th><td>Calculates what areas we should worry about.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/activate">activate</a></th><td>Proc that handles activation of the firelock and all this details</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/add_as_source">add_as_source</a></th><td>Adds this fire door as a source of trouble to all of its areas</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/adjust_lights_starting_offset">adjust_lights_starting_offset</a></th><td>Sets the offset for the warning lights.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/correct_state">correct_state</a></th><td>Corrects the current state of the door, based on its activity.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/crack_open">crack_open</a></th><td>Open the firedoor without resetting existing alarms</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/release_constraints">release_constraints</a></th><td>Please be called 3 seconds after the LAST open, rather then 3 seconds after the first
Reset our temporary alarm ignoring
Consider if we should close ourselves/our neighbors or not</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/remove_as_source">remove_as_source</a></th><td>Removes this firedoor from all areas it's serving as a source of problems for</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/reset">reset</a></th><td>Proc that handles reset steps</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/start_activation_process">start_activation_process</a></th><td>Begins activation process of us and our neighbors.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/start_deactivation_process">start_deactivation_process</a></th><td>Begins deactivation process of us and our neighbors.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/try_to_crowbar">try_to_crowbar</a></th><td>We check for adjacency when using the primary attack.</td></tr>
            <tr><th><a href="obj/machinery/door/firedoor.html#proc/try_to_crowbar_secondary">try_to_crowbar_secondary</a></th><td>A simple toggle for firedoors between on and off</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/active"><aside class="declaration">var </aside>active
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L51">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 51"/></a></h3>
        <p>Is this firelock active/closed?</p><h3 id="var/affecting_areas"><aside class="declaration">var </aside>affecting_areas
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L39">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 39"/></a></h3>
        <p>List of areas we handle. See CalculateAffectingAreas()</p><h3 id="var/alarm_type"><aside class="declaration">var </aside>alarm_type
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L49">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 49"/></a></h3>
        <p>Type of alarm we're under. See code/defines/firealarm.dm for the list. This var being null means there is no alarm.</p><h3 id="var/assemblytype"><aside class="declaration">var </aside>assemblytype
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L36">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 36"/></a></h3>
        <p>The type of door frame to drop during deconstruction</p><h3 id="var/being_held_open"><aside class="declaration">var </aside>being_held_open
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L45">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 45"/></a></h3>
        <p>Tracks if the firelock is being held open by a crowbar. If so, we don't close until they walk away</p><h3 id="var/ignore_alarms"><aside class="declaration">var </aside>ignore_alarms
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L47">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 47"/></a></h3>
        <p>Should the firelock ignore atmosphere when choosing to stay open/closed?</p><h3 id="var/is_playing_alarm"><aside class="declaration">var </aside>is_playing_alarm
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L62">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 62"/></a></h3>
        <p>Keeps track of if we're playing the alarm sound loop (as only one firelock per group should be). Used during power changes.</p><h3 id="var/issue_turfs"><aside class="declaration">var </aside>issue_turfs
            <aside>&ndash; /list/turf</aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L43">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 43"/></a></h3>
        <p>List of problem turfs with bad temperature</p><h3 id="var/light_xoffset"><aside class="declaration">var </aside>light_xoffset
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L30">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 30"/></a></h3>
        <p>X offset for the overlay lights, so that they line up with the thin border firelocks</p><h3 id="var/light_yoffset"><aside class="declaration">var </aside>light_yoffset
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L32">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 32"/></a></h3>
        <p>Y offset for the overlay lights, so that they line up with the thin border firelocks</p><h3 id="var/luminosity">luminosity
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L28">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 28"/></a></h3>
        <p>Trick to get the glowing overlay visible from a distance</p><h3 id="var/merger_id"><aside class="declaration">var </aside>merger_id
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L53">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 53"/></a></h3>
        <p>The merger_id and merger_typecache variables are used to make rows of firelocks activate at the same time.</p><h3 id="var/my_area"><aside class="declaration">var </aside>my_area
            <aside>&ndash; /<a href="area.html">area</a></aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L41">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 41"/></a></h3>
        <p>For the few times we affect only the area we're actually in. Set during Init. If we get moved, we don't update, but this is consistant with fire alarms and also kinda funny so call it intentional.</p><h3 id="var/soundloop"><aside class="declaration">var </aside>soundloop
            <aside>&ndash; /<a href="datum.html">datum</a>/<a href="datum/looping_sound.html">looping_sound</a>/firealarm</aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L60">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 60"/></a></h3>
        <p>looping sound datum for our fire alarm siren.</p><h3 id="var/warn_lights"><aside class="declaration">var </aside>warn_lights
            <aside>&ndash; /mutable_appearance</aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L57">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 57"/></a></h3>
        <p>Overlay object for the warning lights. This and some plane settings allows the lights to glow in the dark.</p><h2 id="proc">Proc Details</h2><h3 id="proc/CalculateAffectingAreas"><aside class="declaration">proc </aside>CalculateAffectingAreas<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L191">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 191"/></a></aside>
        </h3>
        <p>Calculates what areas we should worry about.</p>
<p>This proc builds a list of areas we are in and areas we border
and writes it to affecting_areas.</p><h3 id="proc/activate"><aside class="declaration">proc </aside>activate<aside>(code) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L352">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 352"/></a></aside>
        </h3>
        <p>Proc that handles activation of the firelock and all this details</p>
<p>Sets active and alarm type to properly represent our state.
Also calls set_status() on all fire alarms in all affected areas, tells
the area the firelock sits in to report the event (AI, alarm consoles, etc)
and finally calls correct_state(), which will handle opening or closing
this fire lock.</p><h3 id="proc/add_as_source"><aside class="declaration">proc </aside>add_as_source<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L369">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 369"/></a></aside>
        </h3>
        <p>Adds this fire door as a source of trouble to all of its areas</p><h3 id="proc/adjust_lights_starting_offset"><aside class="declaration">proc </aside>adjust_lights_starting_offset<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L108">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 108"/></a></aside>
        </h3>
        <p>Sets the offset for the warning lights.</p>
<p>Used for special firelocks with light overlays that don't line up to their sprite.</p><h3 id="proc/correct_state"><aside class="declaration">proc </aside>correct_state<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L636">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 636"/></a></aside>
        </h3>
        <p>Corrects the current state of the door, based on its activity.</p>
<p>This proc is called after weld and power restore events. Gives the
illusion that the door is constantly attempting to move without actually
having to process it. Timers also call this, so that if activity
changes during the timer, the door doesn't close or open incorrectly.</p><h3 id="proc/crack_open"><aside class="declaration">proc </aside>crack_open<aside>(delay) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L401">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 401"/></a></aside>
        </h3>
        <p>Open the firedoor without resetting existing alarms</p>
<ul>
<li>delay - Reconsider if this door should be open or closed after some period</li>
</ul><h3 id="proc/release_constraints"><aside class="declaration">proc </aside>release_constraints<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L420">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 420"/></a></aside>
        </h3>
        <p>Please be called 3 seconds after the LAST open, rather then 3 seconds after the first
Reset our temporary alarm ignoring
Consider if we should close ourselves/our neighbors or not</p><h3 id="proc/remove_as_source"><aside class="declaration">proc </aside>remove_as_source<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L428">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 428"/></a></aside>
        </h3>
        <p>Removes this firedoor from all areas it's serving as a source of problems for</p><h3 id="proc/reset"><aside class="declaration">proc </aside>reset<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L385">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 385"/></a></aside>
        </h3>
        <p>Proc that handles reset steps</p>
<p>Clears the alarm state and attempts to open the firelock.</p><h3 id="proc/start_activation_process"><aside class="declaration">proc </aside>start_activation_process<aside>(code) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L322">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 322"/></a></aside>
        </h3>
        <p>Begins activation process of us and our neighbors.</p>
<p>This proc will call activate() on every fire lock (including us) listed
in the merge group datum. Returns without doing anything if we're already active, cause of course</p>
<p>Arguments:
code should be one of three defined alarm types, or can be not supplied. Will dictate the color of the fire alarm lights, and defaults to &quot;firelock_alarm_type_generic&quot;</p><h3 id="proc/start_deactivation_process"><aside class="declaration">proc </aside>start_deactivation_process<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L336">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 336"/></a></aside>
        </h3>
        <p>Begins deactivation process of us and our neighbors.</p>
<p>This proc will call reset() on every fire lock (including us) listed
in the merge group datum. sets our alarm type to null, signifying no alarm.</p><h3 id="proc/try_to_crowbar">try_to_crowbar<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/acting_object, /<a href="mob.html">mob</a>/user) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L533">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 533"/></a></aside>
        </h3>
        <p>We check for adjacency when using the primary attack.</p><h3 id="proc/try_to_crowbar_secondary"><aside class="parent"><a title="/obj/machinery/door" href="obj/machinery/door.html#proc/try_to_crowbar_secondary">&uarr;</a></aside>try_to_crowbar_secondary<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/acting_object, /<a href="mob.html">mob</a>/user) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/game/machinery/doors/firedoor.dm#L553">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;doors&#x2F;firedoor.dm 553"/></a></aside>
        </h3>
        <p>A simple toggle for firedoors between on and off</p></main>
<footer>
    tgstation.dme
    <a href="https://github.com/fulpstation/fulpstation/tree/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc">629e2d4</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.7.3</a></footer>
</body>
</html>
