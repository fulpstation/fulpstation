<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../../../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;datum&#x2F;controller&#x2F;subsystem&#x2F;ticker - &#x2F;tg&#x2F; Station 13</title>
</head>
<body>
<header>
    <a href="index.html">&#x2F;tg&#x2F; Station 13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="datum/controller/subsystem/ticker.html#var">Var Details</a> - <a href="datum/controller/subsystem/ticker.html#proc">Proc Details</a></header>
<main>
<h1>ticker <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/ticker.html">ticker</a></aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L3">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 3"/></a></h1>

<table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/current_state">current_state</a></th><td>state of current round (used by process()) Use the defines GAME_STATE_* !</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/emergency_reason">emergency_reason</a></th><td>Why an emergency shuttle was called</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/force_ending">force_ending</a></th><td>Boolean to track if round should be forcibly ended next ticker tick.
Set by admin intervention (<a href="code/__DEFINES/subsystems.html#define/ADMIN_FORCE_END_ROUND" title="ADMIN_FORCE_END_ROUND">ADMIN_FORCE_END_ROUND</a>)
or a &quot;round-ending&quot; event, like summoning Nar'Sie, a blob victory, the nuke going off, etc. (<a href="code/__DEFINES/subsystems.html#define/FORCE_END_ROUND" title="FORCE_END_ROUND">FORCE_END_ROUND</a>)</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/hearts">hearts</a></th><td>People who have been commended and will receive a heart</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/news_report">news_report</a></th><td>What is going to be reported to other stations at end of round?</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/setup_done">setup_done</a></th><td>Boolean to track and check if our subsystem setup is done.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/start_immediately">start_immediately</a></th><td>If TRUE, there is no lobby phase, the game starts immediately.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/totalPlayers">totalPlayers</a></th><td>Num of players, used for pregame stats on statpanel</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/totalPlayersReady">totalPlayersReady</a></th><td>Num of ready players, used for pregame stats on statpanel (only viewable by admins)</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/total_admins_ready">total_admins_ready</a></th><td>Num of ready admins, used for pregame stats on statpanel (only viewable by admins)</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/HandleRandomHardcoreScore">HandleRandomHardcoreScore</a></th><td>Handles random hardcore point rewarding if it applies.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/antag_report">antag_report</a></th><td>gotta escape nerd</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/award_service">award_service</a></th><td>total service income
This is the richest account on station at roundend.
This is the station's total wealth at the end of the round.
How many players joined the round.
Awards the service department an achievement and updates the chef and bartender's highscore for tourists served.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/choose_round_end_song">choose_round_end_song</a></th><td>The reference to the end of round sound that we have chosen.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/declare_completion">declare_completion</a></th><td>no score no glory</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/handle_hearts">handle_hearts</a></th><td>Once the round is actually over, cycle through the ckeys in the hearts list and give them the hearted status</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/hardcore_random_report">hardcore_random_report</a></th><td>Generate a report for all players who made it out alive with a hardcore random character and prints their final score</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/log_roundend_report">log_roundend_report</a></th><td>Log the round-end report as an HTML file</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/market_report">market_report</a></th><td>Generate a report for how much money is on station, as well as the richest crewmember on the station.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/poll_hearts">poll_hearts</a></th><td>Called when the shuttle starts launching back to centcom, polls a few random players who joined the round for commendations</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/current_state"><aside class="declaration">var </aside>current_state
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L12">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 12"/></a></h3>
        <p>state of current round (used by process()) Use the defines GAME_STATE_* !</p><h3 id="var/emergency_reason"><aside class="declaration">var </aside>emergency_reason
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L71">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 71"/></a></h3>
        <p>Why an emergency shuttle was called</p><h3 id="var/force_ending"><aside class="declaration">var </aside>force_ending
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L16">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 16"/></a></h3>
        <p>Boolean to track if round should be forcibly ended next ticker tick.
Set by admin intervention (<a href="code/__DEFINES/subsystems.html#define/ADMIN_FORCE_END_ROUND" title="ADMIN_FORCE_END_ROUND">ADMIN_FORCE_END_ROUND</a>)
or a &quot;round-ending&quot; event, like summoning Nar'Sie, a blob victory, the nuke going off, etc. (<a href="code/__DEFINES/subsystems.html#define/FORCE_END_ROUND" title="FORCE_END_ROUND">FORCE_END_ROUND</a>)</p><h3 id="var/hearts"><aside class="declaration">var </aside>hearts
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L66">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 66"/></a></h3>
        <p>People who have been commended and will receive a heart</p><h3 id="var/news_report"><aside class="declaration">var </aside>news_report
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L54">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 54"/></a></h3>
        <p>What is going to be reported to other stations at end of round?</p><h3 id="var/setup_done"><aside class="declaration">var </aside>setup_done
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L20">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 20"/></a></h3>
        <p>Boolean to track and check if our subsystem setup is done.</p><h3 id="var/start_immediately"><aside class="declaration">var </aside>start_immediately
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L18">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 18"/></a></h3>
        <p>If TRUE, there is no lobby phase, the game starts immediately.</p><h3 id="var/totalPlayers"><aside class="declaration">var </aside>totalPlayers
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L44">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 44"/></a></h3>
        <p>Num of players, used for pregame stats on statpanel</p><h3 id="var/totalPlayersReady"><aside class="declaration">var </aside>totalPlayersReady
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L46">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 46"/></a></h3>
        <p>Num of ready players, used for pregame stats on statpanel (only viewable by admins)</p><h3 id="var/total_admins_ready"><aside class="declaration">var </aside>total_admins_ready
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L48">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 48"/></a></h3>
        <p>Num of ready admins, used for pregame stats on statpanel (only viewable by admins)</p><h2 id="proc">Proc Details</h2><h3 id="proc/HandleRandomHardcoreScore"><aside class="declaration">proc </aside>HandleRandomHardcoreScore<aside>(/<a href="client.html">client</a>/player_client) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L184">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 184"/></a></aside>
        </h3>
        <p>Handles random hardcore point rewarding if it applies.</p><h3 id="proc/antag_report"><aside class="declaration">proc </aside>antag_report<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L585">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 585"/></a></aside>
        </h3>
        <p>gotta escape nerd</p><h3 id="proc/award_service"><aside class="declaration">proc </aside>award_service<aside>(award) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L545">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 545"/></a></aside>
        </h3>
        <p>total service income
This is the richest account on station at roundend.
This is the station's total wealth at the end of the round.
How many players joined the round.
Awards the service department an achievement and updates the chef and bartender's highscore for tourists served.</p>
<p>Arguments:</p>
<ul>
<li>award: Achievement to give service department</li>
</ul><h3 id="proc/choose_round_end_song"><aside class="declaration">proc </aside>choose_round_end_song<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/controllers/subsystem/ticker.dm#L731">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 731"/></a></aside>
        </h3>
        <p>The reference to the end of round sound that we have chosen.</p><h3 id="proc/declare_completion"><aside class="declaration">proc </aside>declare_completion<aside>(was_forced) 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L204">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 204"/></a></aside>
        </h3>
        <p>no score no glory</p><h3 id="proc/handle_hearts"><aside class="declaration">proc </aside>handle_hearts<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/hearted.dm#L26">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;hearted.dm 26"/></a></aside>
        </h3>
        <p>Once the round is actually over, cycle through the ckeys in the hearts list and give them the hearted status</p><h3 id="proc/hardcore_random_report"><aside class="declaration">proc </aside>hardcore_random_report<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L565">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 565"/></a></aside>
        </h3>
        <p>Generate a report for all players who made it out alive with a hardcore random character and prints their final score</p><h3 id="proc/log_roundend_report"><aside class="declaration">proc </aside>log_roundend_report<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L368">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 368"/></a></aside>
        </h3>
        <p>Log the round-end report as an HTML file</p>
<p>Composits the roundend report, and saves it in two locations.
The report is first saved along with the round's logs
Then, the report is copied to a fixed directory specifically for
housing the server's last roundend report. In this location,
the file will be overwritten at the end of each shift.</p><h3 id="proc/market_report"><aside class="declaration">proc </aside>market_report<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/roundend.dm#L488">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 488"/></a></aside>
        </h3>
        <p>Generate a report for how much money is on station, as well as the richest crewmember on the station.</p><h3 id="proc/poll_hearts"><aside class="declaration">proc </aside>poll_hearts<aside>() 
        
    
            <a href="https://github.com/fulpstation/fulpstation/blob/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc/code/__HELPERS/hearted.dm#L2">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;hearted.dm 2"/></a></aside>
        </h3>
        <p>Called when the shuttle starts launching back to centcom, polls a few random players who joined the round for commendations</p></main>
<footer>
    tgstation.dme
    <a href="https://github.com/fulpstation/fulpstation/tree/629e2d40b55cd98862d1c91ccc4f04e9286e1fdc">629e2d4</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.7.3</a></footer>
</body>
</html>
